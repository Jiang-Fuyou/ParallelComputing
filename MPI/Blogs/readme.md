Resources and codes are from http://www.cnblogs.com/xbf9xbf/default.html?page=1
